(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-566cce6a"],{"02f4":function(e,t,n){var r=n("4588"),a=n("be13");e.exports=function(e){return function(t,n){var i,l,s=String(a(t)),u=r(n),o=s.length;return u<0||u>=o?e?"":void 0:(i=s.charCodeAt(u),i<55296||i>56319||u+1===o||(l=s.charCodeAt(u+1))<56320||l>57343?e?s.charAt(u):i:e?s.slice(u,u+2):l-56320+(i-55296<<10)+65536)}}},"0390":function(e,t,n){"use strict";var r=n("02f4")(!0);e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},"0d12":function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-form-item",{attrs:{label:e.label,prop:e.name}},[n("el-input",{attrs:{type:"textarea",name:e.name,placeholder:e.placeholder,maxlength:e.maxlength},model:{value:e.observeValue,callback:function(t){e.observeValue=t},expression:"observeValue"}}),e._v(" "),n("span",{staticClass:"notice-grey"},[e._v(e._s(e.messageMaxlength))])],1)},a=[],i=(n("c5f6"),{name:"TextareaInput",props:{value:{type:String,required:!0},name:{type:String,required:!0},label:{type:String,required:!0},placeholder:{type:String,required:!0},message:{type:String,default:function(){return""}},maxlength:{type:[Number,String],default:""}},computed:{observeValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}},messageMaxlength:function(){return this.maxlength>0?"".concat(this.message?this.message+", ":"","字數限制：").concat(this.observeValue.length,"/").concat(this.maxlength):this.message}}}),l=i,s=n("2877"),u=Object(s["a"])(l,r,a,!1,null,null,null);t["a"]=u.exports},1:function(e,t){},"13db":function(e,t,n){"use strict";n("96cf");var r=n("3b8d"),a=n("b775");function i(e){return Object(a["a"])({url:"/v1/sms",method:"post",data:e})}function l(){return Object(a["a"])({url:"/v1/sms",method:"get"})}function s(e){return Object(a["a"])({url:"/v1/sms/batch",method:"post",data:e})}t["a"]=function(){return{namespaced:!0,state:{SMSList:[]},getters:{},mutations:{SET_SMS_LIST:function(e,t){e.SMSList=t}},actions:{SEND_SMS:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.commit,e.next=3,i(n).then((function(e){return e.data}));case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));function t(t,n){return e.apply(this,arguments)}return t}(),GET_SMS_LIST:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.next=3,l().then((function(e){return e.data}));case 3:r=e.sent,n("SET_SMS_LIST",r);case 5:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),SEND_SMS_BATCH:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.commit,e.next=3,s(n).then((function(e){return e.data}));case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));function t(t,n){return e.apply(this,arguments)}return t}()}}}},2:function(e,t){},"214f":function(e,t,n){"use strict";n("b0c5");var r=n("2aba"),a=n("32e9"),i=n("79e5"),l=n("be13"),s=n("2b4c"),u=n("520a"),o=s("species"),c=!i((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),f=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();e.exports=function(e,t,n){var h=s(e),m=!i((function(){var t={};return t[h]=function(){return 7},7!=""[e](t)})),p=m?!i((function(){var t=!1,n=/a/;return n.exec=function(){return t=!0,null},"split"===e&&(n.constructor={},n.constructor[o]=function(){return n}),n[h](""),!t})):void 0;if(!m||!p||"replace"===e&&!c||"split"===e&&!f){var d=/./[h],v=n(l,h,""[e],(function(e,t,n,r,a){return t.exec===u?m&&!a?{done:!0,value:d.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}})),g=v[0],b=v[1];r(String.prototype,e,g),a(RegExp.prototype,h,2==t?function(e,t){return b.call(e,this,t)}:function(e){return b.call(e,this)})}}},"28a5":function(e,t,n){"use strict";var r=n("aae3"),a=n("cb7c"),i=n("ebd6"),l=n("0390"),s=n("9def"),u=n("5f1b"),o=n("520a"),c=n("79e5"),f=Math.min,h=[].push,m="split",p="length",d="lastIndex",v=4294967295,g=!c((function(){RegExp(v,"y")}));n("214f")("split",2,(function(e,t,n,c){var b;return b="c"=="abbc"[m](/(b)*/)[1]||4!="test"[m](/(?:)/,-1)[p]||2!="ab"[m](/(?:ab)*/)[p]||4!="."[m](/(.?)(.?)/)[p]||"."[m](/()()/)[p]>1||""[m](/.?/)[p]?function(e,t){var a=String(this);if(void 0===e&&0===t)return[];if(!r(e))return n.call(a,e,t);var i,l,s,u=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),f=0,m=void 0===t?v:t>>>0,g=new RegExp(e.source,c+"g");while(i=o.call(g,a)){if(l=g[d],l>f&&(u.push(a.slice(f,i.index)),i[p]>1&&i.index<a[p]&&h.apply(u,i.slice(1)),s=i[0][p],f=l,u[p]>=m))break;g[d]===i.index&&g[d]++}return f===a[p]?!s&&g.test("")||u.push(""):u.push(a.slice(f)),u[p]>m?u.slice(0,m):u}:"0"[m](void 0,0)[p]?function(e,t){return void 0===e&&0===t?[]:n.call(this,e,t)}:n,[function(n,r){var a=e(this),i=void 0==n?void 0:n[t];return void 0!==i?i.call(n,a,r):b.call(String(a),n,r)},function(e,t){var r=c(b,e,this,t,b!==n);if(r.done)return r.value;var o=a(e),h=String(this),m=i(o,RegExp),p=o.unicode,d=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(g?"y":"g"),S=new m(g?o:"^(?:"+o.source+")",d),x=void 0===t?v:t>>>0;if(0===x)return[];if(0===h.length)return null===u(S,h)?[h]:[];var y=0,_=0,w=[];while(_<h.length){S.lastIndex=g?_:0;var M,E=u(S,g?h:h.slice(_));if(null===E||(M=f(s(S.lastIndex+(g?0:_)),h.length))===y)_=l(h,_,p);else{if(w.push(h.slice(y,_)),w.length===x)return w;for(var R=1;R<=E.length-1;R++)if(w.push(E[R]),w.length===x)return w;_=y=M}}return w.push(h.slice(y)),w}]}))},"294b":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{padding:"30px"}},[n("div",{staticStyle:{with:"100%"}},[n("div",{staticStyle:{position:"relative"}},[e._m(0),e._v(" "),n("el-tabs",{attrs:{type:"border-card"}},[n("el-tab-pane",{attrs:{label:"單筆發送"}},[n("el-form",{ref:"ruleForm",staticStyle:{width:"80%","margin-left":"5%"},attrs:{model:e.SMSData,"label-position":"left","label-width":"15%",rules:e.SMSRules}},[e._l(e.fields,(function(t){return n(t.type,{key:t.name,tag:"component",attrs:{placeholder:t.placeholder,name:t.name,label:t.label,disabled:t.disabled,options:t.options,maxlength:t.maxlength},model:{value:e.SMSData[t.name],callback:function(n){e.$set(e.SMSData,t.name,n)},expression:"SMSData[field.name]"}})})),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("發送")]),e._v(" "),n("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],2)],1),e._v(" "),n("el-tab-pane",{attrs:{label:"分批發送"}},[n("el-form",{ref:"ruleFormBatch",staticStyle:{width:"80%","margin-left":"5%"},attrs:{model:e.SMSDataBatch,"label-position":"left","label-width":"15%",rules:e.SMSRulesBatch}},[e._l(e.fieldsBatch,(function(t){return n(t.type,{key:t.name,tag:"component",attrs:{placeholder:t.placeholder,name:t.name,label:t.label,disabled:t.disabled,options:t.options,maxlength:t.maxlength},model:{value:e.SMSDataBatch[t.name],callback:function(n){e.$set(e.SMSDataBatch,t.name,n)},expression:"SMSDataBatch[field.name]"}})})),e._v(" "),n("el-form-item",{attrs:{label:"上傳檔案"}},[n("el-upload",{staticClass:"upload-demo",attrs:{action:"","before-remove":e.beforeRemove,"on-change":e.handleChange,multiple:"",limit:1,"on-exceed":e.handleExceed,"file-list":e.fileList,"auto-upload":!1}},[n("el-button",{attrs:{size:"small",type:"info"}},[e._v("上傳 CSV 或 XLSX")])],1)],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleFormBatch")}}},[e._v("發送")]),e._v(" "),n("el-button",{on:{click:function(t){return e.resetForm("ruleFormBatch")}}},[e._v("重置")])],1),e._v(" "),n("div",[n("h4",[e._v("手機名單")]),e._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[n("el-table-column",{attrs:{type:"index",label:"索引",width:"180"}}),e._v(" "),n("el-table-column",{attrs:{prop:"mobile",label:"手機號碼",width:"180"}})],1)],1)],2)],1)],1)],1)])])},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h2",[e._v("發送簡訊")])])}],i=(n("ac6a"),n("28a5"),n("96cf"),n("3b8d")),l=(n("7f7f"),n("1146")),s=n.n(l),u=n("13db"),o=n("61f7"),c=n("0d12"),f=n("e94b"),h=new FileReader,m={name:"SendMessage",components:{TextareaInput:c["a"],TextInput:f["a"]},data:function(){var e=function(e,t,n){var r=/09[0-9]{8}/;r.test(t)?n():n(new Error)},t=[{type:"TextareaInput",name:"message",value:"",label:"訊息內容",placeholder:"",maxlength:70,rules:[{required:!0,message:"請填寫簡訊內容",trigger:"blur"}]},{type:"TextInput",name:"mobile",value:"",label:"手機號碼",placeholder:"請輸入手機號碼",maxlength:10,rules:[{required:!0,message:"請輸入手機號碼",trigger:"blur",validator:e}]}],n=t.reduce((function(e,t){return e[t.name]=t.value,e}),{}),r=t.reduce((function(e,t){return e[t.name]=t.rules,e}),{}),a=[{type:"TextareaInput",name:"message",value:"",label:"訊息內容",placeholder:"",maxlength:70,rules:[{required:!0,message:"請填寫簡訊內容",trigger:"blur"}]}],i=a.reduce((function(e,t){return e[t.name]=t.value,e}),{}),l=a.reduce((function(e,t){return e[t.name]=t.rules,e}),{});return{fields:t,fieldsBatch:a,SMSRules:r,SMSData:n,SMSDataBatch:i,SMSRulesBatch:l,fileList:[],tableData:[]}},mounted:function(){void 0===this.$store._modules.root._children["SMS"]&&this.$store.registerModule("SMS",Object(u["a"])())},beforeDestroy:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:void 0!==this.$store._modules.root._children["SMS"]&&this.$store.unregisterModule("SMS");case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{submitForm:function(e){"ruleForm"===e?this.send_SMS_single():this.send_SMS_batch()},send_SMS_single:function(){var e=this;this.$refs["ruleForm"].validate((function(t){if(!t)return!1;e.$store.dispatch("SMS/SEND_SMS",e.SMSData).then((function(t){"Success"===t.message&&e.$message.success("發送成功")})).catch((function(){e.$message.error("發送錯誤")}))}))},send_SMS_batch:function(){var e=this,t=[];this.tableData.map((function(e){t.push(e.mobile)}));var n={message:this.SMSDataBatch.message,mobileList:t};0!==t.length?this.$refs["ruleFormBatch"].validate((function(t){if(!t)return!1;e.$store.dispatch("SMS/SEND_SMS_BATCH",n).then((function(t){"Success"===t.message&&e.$message.success("發送成功")})).catch((function(){e.$message.error("發送錯誤")}))})):alert("檔案錯誤")},resetForm:function(e){this.$refs[e].resetFields(),this.fileList=[],this.tableData=[]},handleChange:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:"text/csv"===t.raw.type?this.csvloader(t):"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===t.raw.type?this.xlsxloader(t):(alert("檔案錯誤！"),this.myEdit.member=[]);case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),csvloader:function(e){var t,n=this;h.readAsText(e.raw),h.onload=function(e){if(e.target.result){t=e.target.result.split(/\r\n|\n/),t.shift();var r=[];t=t.map((function(e){Object(o["b"])(e)&&r.push({mobile:e})})),n.tableData=r}}},xlsxloader:function(e){var t=this,n=[];h.readAsBinaryString(e.raw),h.onload=function(e){if(e.target.result){var r=s.a.read(e.target.result,{type:"binary"});r.SheetNames.forEach((function(e){var t=s.a.utils.sheet_to_row_object_array(r.Sheets[e]);t.length>0&&(n=n.concat(t))}));var a=[];n=n.map((function(e){Object(o["b"])(e["mobile"])&&a.push({mobile:e["mobile"]})})),t.tableData=a}}},handleExceed:function(e,t){this.$message.warning("只能選擇一個文件,請先移除文件！")},beforeRemove:function(e,t){var n=this;return this.$confirm("确定移除 ".concat(e.name,"？")).then((function(){n.fileList=[],n.tableData=[]}))}}},p=m,d=n("2877"),v=Object(d["a"])(p,r,a,!1,null,null,null);t["default"]=v.exports},3:function(e,t){},"520a":function(e,t,n){"use strict";var r=n("0bfb"),a=RegExp.prototype.exec,i=String.prototype.replace,l=a,s="lastIndex",u=function(){var e=/a/,t=/b*/g;return a.call(e,"a"),a.call(t,"a"),0!==e[s]||0!==t[s]}(),o=void 0!==/()??/.exec("")[1],c=u||o;c&&(l=function(e){var t,n,l,c,f=this;return o&&(n=new RegExp("^"+f.source+"$(?!\\s)",r.call(f))),u&&(t=f[s]),l=a.call(f,e),u&&l&&(f[s]=f.global?l.index+l[0].length:t),o&&l&&l.length>1&&i.call(l[0],n,(function(){for(c=1;c<arguments.length-2;c++)void 0===arguments[c]&&(l[c]=void 0)})),l}),e.exports=l},"5f1b":function(e,t,n){"use strict";var r=n("23c6"),a=RegExp.prototype.exec;e.exports=function(e,t){var n=e.exec;if("function"===typeof n){var i=n.call(e,t);if("object"!==typeof i)throw new TypeError("RegExp exec method returned something other than an Object or null");return i}if("RegExp"!==r(e))throw new TypeError("RegExp#exec called on incompatible receiver");return a.call(e,t)}},b0c5:function(e,t,n){"use strict";var r=n("520a");n("5ca1")({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},e94b:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-form-item",{attrs:{label:e.label,prop:e.name}},[n("el-input",{attrs:{type:"text",name:e.name,placeholder:e.placeholder,maxlength:e.maxlength,disabled:e.disabled},model:{value:e.observeValue,callback:function(t){e.observeValue=t},expression:"observeValue"}}),e._v(" "),n("span",{staticClass:"notice-grey"},[e._v(e._s(e.messageMaxlength))])],1)},a=[],i=(n("c5f6"),{name:"TextInput",props:{value:{type:[String,Number],required:!0},name:{type:String,required:!0},label:{type:String,required:!0},placeholder:{type:String,required:!0},message:{type:String,default:function(){return""}},maxlength:{type:[Number,String],default:""},disabled:{type:Boolean,default:!1}},computed:{observeValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}},messageMaxlength:function(){return this.maxlength>0?"".concat(this.message?this.message+", ":"","字數限制：").concat(this.observeValue.length,"/").concat(this.maxlength):this.message}}}),l=i,s=n("2877"),u=Object(s["a"])(l,r,a,!1,null,null,null);t["a"]=u.exports}}]);