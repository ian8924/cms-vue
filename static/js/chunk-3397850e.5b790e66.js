(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3397850e"],{"30f3":function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"選擇日期",visible:t.showDialog,"before-close":t.handleClose,width:"600px","show-close":!1}},[a("el-form",{ref:"myEdit",staticStyle:{width:"70%","margin-left":"10%"},attrs:{"label-position":"left","label-width":"20%"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{"value-format":"yyyy-MM-dd",type:"daterange","range-separator":"至","start-placeholder":"開始日期","end-placeholder":"結束日期"},model:{value:t.dateValue,callback:function(e){t.dateValue=e},expression:"dateValue"}}),t._v(" "),a("el-button",{staticStyle:{"margin-top":"30px"},attrs:{type:"info"},on:{click:t.check}},[t._v("確定")])],1)],1)},n=[],i={props:{showDialog:{type:Boolean,default:!1}},data:function(){return{dateValue:[]}},methods:{check:function(){this.dateValue&&2===this.dateValue.length&&this.$emit("changeDateRange",this.dateValue)},handleClose:function(t){this.$emit("closeDialog",!1),t()}}},o=i,s=a("2877"),c=Object(s["a"])(o,r,n,!1,null,null,null);e["a"]=c.exports},"3e12":function(t,e,a){"use strict";a("96cf");var r=a("3b8d"),n=a("b775");function i(t){return Object(n["a"])({url:"/v1/data/wallet/rowdata",method:"post",data:t})}function o(t){return Object(n["a"])({url:"/v1/data/wallet/totalcount",method:"post",data:t})}function s(t){return Object(n["a"])({url:"/v1/data/wallet/open",method:"post",data:t})}function c(t){return Object(n["a"])({url:"/v1/data/wallet/download",method:"post",data:t})}function u(t){return Object(n["a"])({url:"/v1/data/wallet/googlepay",method:"post",data:t})}function l(t){return Object(n["a"])({url:"/v1/data/wallet/qrcode",method:"post",data:t})}function h(t){return Object(n["a"])({url:"/v1/data/wallet/exchange",method:"post",data:t})}function d(t){return Object(n["a"])({url:"/v1/data/wallet/roaminbar",method:"post",data:t})}e["a"]=function(){return{namespaced:!0,state:{TICKETS:{}},getters:{},mutations:{SET_TICKET_LIST:function(t,e){t.TICKETS=e}},actions:{GET_ALL_TICKETS:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,a){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,t.next=3,i(a).then((function(t){return t.data})).catch((function(){return[]}));case 3:return n=t.sent,n===[]&&this.$message.error("查無資料"),r("SET_TICKET_LIST",n),t.abrupt("return",n);case 7:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),GET_ALL_TICKETS_TOTAL:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,a){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,t.next=3,o(a).then((function(t){return t.data})).catch((function(){return[]}));case 3:return n=t.sent,n===[]&&this.$message.error("查無資料"),r("SET_TICKET_LIST",n),t.abrupt("return",n);case 7:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),GET_TICKETS_OPENED:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,a){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,t.next=3,s(a).then((function(t){return t.data})).catch((function(){return[]}));case 3:return n=t.sent,n===[]&&this.$message.error("查無資料"),r("SET_TICKET_LIST",n),t.abrupt("return",n);case 7:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),GET_TICKETS_DOWNLOAD:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,a){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,t.next=3,c(a).then((function(t){return t.data})).catch((function(){return[]}));case 3:return n=t.sent,n===[]&&this.$message.error("查無資料"),r("SET_TICKET_LIST",n),t.abrupt("return",n);case 7:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),GET_TICKETS_GOOGLEPAY_DOWNLOAD:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,a){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,t.next=3,u(a).then((function(t){return t.data})).catch((function(){return[]}));case 3:return n=t.sent,n===[]&&this.$message.error("查無資料"),r("SET_TICKET_LIST",n),t.abrupt("return",n);case 7:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),GET_TICKETS_WRITTENOFF:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,a){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,t.next=3,l(a).then((function(t){return t.data})).catch((function(){return[]}));case 3:return n=t.sent,n===[]&&this.$message.error("查無資料"),r("SET_TICKET_LIST",n),t.abrupt("return",n);case 7:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),GET_TICKETS_WRITTENOFF_TOTAL:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,a){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,t.next=3,h(a).then((function(t){return t.data})).catch((function(){return[]}));case 3:return n=t.sent,n===[]&&this.$message.error("查無資料"),r("SET_TICKET_LIST",n),t.abrupt("return",n);case 7:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),GET_TICKETS_ROAMINGBAR:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,a){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,t.next=3,d(a).then((function(t){return t.data})).catch((function(){return[]}));case 3:return n=t.sent,n===[]&&this.$message.error("查無資料"),r("SET_TICKET_LIST",n),t.abrupt("return",n);case 7:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}()}}}},"6ea9":function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-button",{attrs:{loading:t.downloadLoading,type:"primary",icon:"el-icon-document"},on:{click:t.handleDownload}},[t._v("\n  下載 Excel\n")])},n=[],i={name:"ButtonExcelDownload",props:{filename:{type:String,default:"default"},dataArray:{type:Array,default:function(){return[]}},keyArray:{type:Array,default:function(){return[]}},tNameArray:{type:Array,default:function(){return[]}}},data:function(){return{autoWidth:!0,bookType:"xlsx",downloadLoading:!1}},mounted:function(){},methods:{handleDownload:function(){var t=this;this.downloadLoading=!0,Promise.all([a.e("chunk-1eb2c821"),a.e("chunk-77998d9e"),a.e("chunk-58293907")]).then(a.bind(null,"4bf8d")).then((function(e){var a=t.tNameArray,r=t.keyArray,n=t.dataArray,i=t.formatJson(r,n);e.export_json_to_excel({header:a,data:i,filename:t.filename,autoWidth:t.autoWidth,bookType:t.bookType}),t.downloadLoading=!1}))},formatJson:function(t,e){return e.map((function(e){return t.map((function(t){return e[t]}))}))}}},o=i,s=a("2877"),c=Object(s["a"])(o,r,n,!1,null,null,null);e["a"]=c.exports},"80df":function(t,e,a){},9401:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{padding:"30px"}},[a("div",{staticStyle:{with:"100%"}},[a("div",{staticStyle:{display:"flex",position:"relative"}},[a("h2",[t._v("已核銷票券列表")]),t._v(" "),a("div",{staticStyle:{position:"absolute",right:"15%","font-size":"10px"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.searchType,callback:function(e){t.searchType=e},expression:"searchType"}},t._l(t.searchOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),t._v(" "),a("el-autocomplete",{staticStyle:{"margin-right":"20px"},attrs:{"popper-class":"my-autocomplete","fetch-suggestions":t.querySearch,placeholder:"請輸入..."},on:{select:t.handleSelect},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.item;return["訂單編號"===t.searchType?a("div",{staticClass:"id"},[t._v(t._s(r.orderID))]):"兌換序號"===t.searchType?a("div",{staticClass:"id"},[t._v(t._s(r.checkCode))]):"兌換店家"===t.searchType?a("div",{staticClass:"id"},[t._v(t._s(r.exchangeStore))]):"店家代號"===t.searchType?a("div",{staticClass:"id"},[t._v(t._s(r.storeStamp))]):t._e(),t._v(" "),"訂單編號"!==t.searchType?a("div",{staticClass:"name"},[t._v(t._s(r.orderID))]):t._e()]}}]),model:{value:t.state,callback:function(e){t.state=e},expression:"state"}},[a("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},on:{click:t.handleIconClick},slot:"suffix"})]),t._v(" "),a("el-button",{attrs:{type:"info",round:""},on:{click:t.refreshList}},[t._v("刷新列表")]),t._v(" "),a("el-button",{attrs:{type:"info",round:""},on:{click:t.openDialog}},[t._v("選擇日期")])],1)]),t._v(" "),a("h4",{staticStyle:{color:"gray"}},[t._v("記錄每筆票券狀態")])]),t._v(" "),a("div",{staticStyle:{"margin-bottom":"20px",display:"flex","justify-content":"space-between"}},[a("el-pagination",{attrs:{background:"","page-sizes":[10,100,400,1e3,t.ticketsList.length],"current-page":t.currentPage,"page-size":t.pagesize,total:t.ticketsList.length,layout:"total, sizes, prev, pager, next"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),t._v(" "),a("ButtonExcelDownload",{staticStyle:{"margin-right":"15%"},attrs:{"data-array":t.ticketsList,filename:t.excelFilename,"key-array":t.excelkey,"t-name-array":t.excelTname}})],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"filterTable",staticStyle:{width:"90%"},attrs:{data:t.ticketsList.slice((t.currentPage-1)*t.pagesize,t.currentPage*t.pagesize)}},[a("el-table-column",{staticStyle:{color:"gray"},attrs:{sortable:"",label:"訂單編號",prop:"orderID",width:"150"}}),t._v(" "),a("el-table-column",{staticStyle:{color:"gray"},attrs:{sortable:"",label:"兌換序號",prop:"checkCode",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{sortable:"",label:"票券名稱",width:"200",prop:"itemName"}}),t._v(" "),a("el-table-column",{attrs:{sortable:"",label:"店家代號",width:"100",prop:"storeStamp"}}),t._v(" "),a("el-table-column",{attrs:{sortable:"",label:"兌換店家",width:"180",prop:"exchangeStore"}}),t._v(" "),a("el-table-column",{staticStyle:{color:"gray"},attrs:{sortable:"",label:"兌換日期",width:"100",prop:"exchangeDate"}}),t._v(" "),a("el-table-column",{staticStyle:{color:"gray"},attrs:{sortable:"",label:"兌換時間",width:"100",prop:"exchangeTime"}}),t._v(" "),a("el-table-column",{attrs:{prop:"walletDuration",label:"票券有效期間",width:"200","show-overflow-tooltip":!0}})],1),t._v(" "),a("DialogDateRange",{attrs:{"show-dialog":t.showDialog},on:{changeDateRange:t.changeDateRange,closeDialog:t.closeDialog}})],1)},n=[],i=(a("96cf"),a("3b8d")),o=a("3e12"),s=a("6ea9"),c=a("30f3"),u={name:"WrittenOffTickets",components:{ButtonExcelDownload:s["a"],DialogDateRange:c["a"]},data:function(){return{currentPage:1,pagesize:10,state:"",loading:!1,searchType:"訂單編號",searchOptions:[{value:"訂單編號",label:"訂單編號"},{value:"兌換序號",label:"兌換序號"},{value:"兌換店家",label:"兌換店家"},{value:"店家代號",label:"店家代號"}],total:[],sDate:"",eDate:"",excelFilename:"已核銷票券",excelTname:["訂單編號","兌換序號","票券名稱","店家代號","兌換店家","兌換日期","兌換時間","票券有效期間"],excelkey:["orderID","checkCode","itemName","storeStamp","exchangeStore","exchangeDate","exchangeTime","walletDuration"],showDialog:!1}},computed:{ticketsList:function(){var t=this;return""===this.state?this.total:"訂單編號"===this.searchType?this.total.filter((function(e,a,r){return 0===e.orderID.indexOf(t.state)})):"兌換序號"===this.searchType?this.total.filter((function(e,a,r){return 0===e.checkCode.indexOf(t.state)})):"兌換店家"===this.searchType?this.total.filter((function(e,a,r){return 0===e.exchangeStore.indexOf(t.state)})):this.total.filter((function(e,a,r){return 0===e.storeStamp.indexOf(t.state)}))}},mounted:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:void 0===this.$store._modules.root._children.datalist&&this.$store.registerModule("datalist",Object(o["a"])()),this.showDialog=!0;case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),beforeDestroy:function(){void 0!==this.$store._modules.root._children.datalist&&this.$store.unregisterModule("datalist")},methods:{refreshList:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,e={sDate:this.sDate,eDate:this.eDate},t.next=4,this.$store.dispatch("datalist/GET_TICKETS_WRITTENOFF",e);case 4:this.total=t.sent,this.loading=!1;case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),handleSizeChange:function(t){this.pagesize=t},handleCurrentChange:function(t){this.currentPage=t},querySearch:function(t,e){this.currentPage=1;var a=this.total,r=t?a.filter(this.createFilter(t)):a;e(r)},createFilter:function(t){return"訂單編號"===this.searchType?function(e){return 0===e.orderID.toLowerCase().indexOf(t.toLowerCase())}:"兌換序號"===this.searchType?function(e){return 0===e.checkCode.toLowerCase().indexOf(t.toLowerCase())}:"兌換店家"===this.searchType?function(e){return 0===e.exchangeStore.toLowerCase().indexOf(t.toLowerCase())}:"店家代號"===this.searchType?function(e){return 0===e.storeStamp.toLowerCase().indexOf(t.toLowerCase())}:void 0},handleSelect:function(t){"訂單編號"===this.searchType?this.state=t.orderID:"兌換序號"===this.searchType?this.state=t.checkCode:"兌換店家"===this.searchType?this.state=t.exchangeStore:"店家代號"===this.searchType&&(this.state=t.storeStamp)},handleIconClick:function(t){},openDialog:function(){this.showDialog=!0},changeDateRange:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,this.showDialog=!1,this.sDate=e[0],this.eDate=e[1],a={sDate:this.sDate,eDate:this.eDate},t.next=7,this.$store.dispatch("datalist/GET_TICKETS_WRITTENOFF",a);case 7:this.total=t.sent,this.loading=!1;case 9:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),closeDialog:function(){this.showDialog=!1}}},l=u,h=(a("aa74"),a("2877")),d=Object(h["a"])(l,r,n,!1,null,"5390803a",null);e["default"]=d.exports},aa74:function(t,e,a){"use strict";var r=a("80df"),n=a.n(r);n.a}}]);