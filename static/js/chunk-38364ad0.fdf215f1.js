(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-38364ad0"],{"0f20":function(t,e,n){"use strict";n.d(e,"p",(function(){return r})),n.d(e,"o",(function(){return a})),n.d(e,"h",(function(){return o})),n.d(e,"e",(function(){return c})),n.d(e,"j",(function(){return s})),n.d(e,"r",(function(){return l})),n.d(e,"a",(function(){return u})),n.d(e,"i",(function(){return d})),n.d(e,"g",(function(){return m})),n.d(e,"q",(function(){return p})),n.d(e,"k",(function(){return f})),n.d(e,"b",(function(){return h})),n.d(e,"l",(function(){return g})),n.d(e,"f",(function(){return v})),n.d(e,"m",(function(){return E})),n.d(e,"n",(function(){return b})),n.d(e,"c",(function(){return _})),n.d(e,"d",(function(){return D}));var i=n("b775");function r(){return Object(i["a"])({url:"/v1/edm/campaigns",method:"get"})}function a(t){return Object(i["a"])({url:"/v1/edm/campaigns/".concat(t),method:"get"})}function o(t,e){return Object(i["a"])({url:"/v1/edm/campaigns/".concat(t),method:"put",data:e})}function c(t){return Object(i["a"])({url:"/v1/edm/campaigns",method:"post",data:t})}function s(t){return Object(i["a"])({url:"/v1/edm/campaigns/".concat(t,"/emails"),method:"get"})}function l(t,e){return"".concat("https://edm.callcarbar.com.tw","/v1/edm/campaigns/").concat(t,"/emails/").concat(e,"/template")}function u(t,e){return Object(i["a"])({url:"/v1/edm/campaigns/".concat(t,"/emails"),method:"post",data:e})}function d(t,e){return Object(i["a"])({url:"/v1/edm/campaigns/".concat(t,"/emails/").concat(e),method:"get"})}function m(t,e,n){return Object(i["a"])({url:"/v1/edm/campaigns/".concat(t,"/emails/").concat(e),method:"put",data:n})}function p(t,e,n){return Object(i["a"])({url:"/v1/edm/campaigns/".concat(t,"/emails/").concat(e,"/send"),method:"post",data:n})}function f(){return Object(i["a"])({url:"/v1/edm/contacts/groups",method:"get"})}function h(t){return Object(i["a"])({url:"/v1/edm/contacts/groups",method:"post",data:t})}function g(t){return Object(i["a"])({url:"/v1/edm/contacts/groups/".concat(t),method:"get"})}function v(t){return Object(i["a"])({url:"/v1/edm/contacts/groups/".concat(t),method:"delete"})}function E(){return Object(i["a"])({url:"/v1/edm/contacts/blacklist",method:"get"})}function b(){return Object(i["a"])({url:"/v1/edm/failure",method:"get"})}function _(t){return Object(i["a"])({url:"/v1/edm/contacts/blacklist",method:"post",data:t})}function D(t){return Object(i["a"])({url:"/v1/edm/failure",method:"post",data:t})}},"2f21":function(t,e,n){"use strict";var i=n("79e5");t.exports=function(t,e){return!!t&&i((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},"55dd":function(t,e,n){"use strict";var i=n("5ca1"),r=n("d8e8"),a=n("4bf8"),o=n("79e5"),c=[].sort,s=[1,2,3];i(i.P+i.F*(o((function(){s.sort(void 0)}))||!o((function(){s.sort(null)}))||!n("2f21")(c)),"Array",{sort:function(t){return void 0===t?c.call(a(this)):c.call(a(this),r(t))}})},fa87:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{padding:"30px"}},[n("div",{staticStyle:{with:"100%"}},[n("div",{staticStyle:{display:"flex",position:"relative"}},[n("h2",[t._v("活動專案管理")]),t._v(" "),n("div",{staticStyle:{position:"absolute",right:"15%"}},[n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["EDM-編輯者"],expression:"['EDM-編輯者']"}],attrs:{type:"success",icon:"el-icon-plus",round:""},on:{click:t.openAddDialog}},[t._v("新增活動")]),t._v(" "),n("el-button",{attrs:{type:"info",icon:t.loadingIcon,round:""},on:{click:t.reFreshList}},[t._v("刷新列表")])],1)])]),t._v(" "),n("div",{staticStyle:{"margin-bottom":"20px"}},[n("el-pagination",{attrs:{background:"","page-sizes":[5,10,20,40,t.tableData.length],"current-page":t.currentPage,"page-size":t.pagesize,total:t.tableData.length,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData.slice((t.currentPage-1)*t.pagesize,t.currentPage*t.pagesize)}},[n("el-table-column",{attrs:{label:"id",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("h4",{staticStyle:{color:"gray"}},[t._v(t._s(e.row.id))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"campaignID",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.campaignID)+"\n      ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"名稱",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.name)+"\n      ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"描述",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticStyle:{color:"gray"}},[t._v(t._s(e.row.description))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tooltip",{directives:[{name:"permission",rawName:"v-permission",value:["EDM-編輯者"],expression:"['EDM-編輯者']"}],staticClass:"item",attrs:{effect:"dark",content:"編輯活動",placement:"top-start"}},[n("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(n){return t.openEditDialog(e.row)}}})],1),t._v(" "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"查看EDM",placement:"top-start"}},[n("el-button",{attrs:{type:"info",icon:"el-icon-thumb",circle:""},on:{click:function(n){return t.goEDMList(e.row.id)}}})],1)]}}])})],1),t._v(" "),n("DialogAddproject",{attrs:{"show-dialog":t.showAddDialog},on:{showAddDialog:t.closeDialog}}),t._v(" "),n("DialogEditproject",{attrs:{"show-dialog":t.showEditDialog,"crrent-slect":t.crrentSlect},on:{showEditDialog:t.closeDialog}})],1)},r=[],a=(n("7f7f"),n("96cf"),n("3b8d")),o=(n("55dd"),n("0f20")),c=function(){return{namespaced:!0,state:{projectList:[]},mutations:{SET_PROJECT_LIST:function(t,e){t.projectList=e.sort((function(t,e){return e.id-t.id}))}},actions:{GET_PROJECT_LIST:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){var n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.commit,t.next=3,Object(o["p"])().then((function(t){return t.data}));case 3:i=t.sent,n("SET_PROJECT_LIST",i);case 5:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),GET_PROJECT_CONTENT:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e,n){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.commit,t.next=3,Object(o["o"])(n).then((function(t){return t.data}));case 3:return i=t.sent,t.abrupt("return",i);case 5:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}(),EDIT_PROJECT_CONTENT:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e,n){var i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.commit,i=n.id,r={campaignID:n.campaignID,name:n.name,description:n.description},t.next=5,Object(o["h"])(i,r).then((function(t){return t.data}));case 5:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}(),ADD_PROJECT:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.commit,t.next=3,Object(o["e"])(n).then((function(t){return t.data}));case 3:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}()}}},s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:"新增專案",visible:t.showDialog,direction:"btt","before-close":t.handleClose,width:"80%"}},[n("el-form",{ref:"myEdit",staticStyle:{width:"70%","margin-left":"10%"},attrs:{model:t.myEdit,"label-position":"left","label-width":"20%"}},[n("el-form-item",{attrs:{label:"campaignID"}},[n("el-input",{attrs:{placeholder:"僅限輸入英文"},model:{value:t.myEdit.campaignID,callback:function(e){t.$set(t.myEdit,"campaignID",e)},expression:"myEdit.campaignID"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"活動名稱"}},[n("el-input",{model:{value:t.myEdit.name,callback:function(e){t.$set(t.myEdit,"name",e)},expression:"myEdit.name"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"活動描述"}},[n("el-input",{attrs:{type:"textarea",rows:5},model:{value:t.myEdit.description,callback:function(e){t.$set(t.myEdit,"description",e)},expression:"myEdit.description"}})],1),t._v(" "),n("el-button",{on:{click:t.save}},[t._v("儲存")])],1)],1)},l=[],u={name:"DialogAddproject",props:{showDialog:{type:Boolean,default:!1}},data:function(){return{myEdit:{}}},watch:{showDialog:function(t){!0===t&&(this.myEdit={})}},methods:{handleClose:function(t){var e=this;this.$confirm("確認關閉？").then((function(n){e.$emit("showAddDialog",!1),t()})).catch((function(t){}))},save:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(this.myEdit.name&&this.myEdit.campaignID&&this.myEdit.description)){t.next=13;break}return t.prev=1,t.next=4,this.$store.dispatch("EDM_project/ADD_PROJECT",this.myEdit);case 4:this.$store.dispatch("EDM_project/GET_PROJECT_LIST"),this.$emit("showAddDialog",!1),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),alert("campaignID重複");case 11:t.next=14;break;case 13:alert("請填寫完整資訊");case 14:case"end":return t.stop()}}),t,this,[[1,8]])})));function e(){return t.apply(this,arguments)}return e}()}},d=u,m=n("2877"),p=Object(m["a"])(d,s,l,!1,null,null,null),f=p.exports,h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:"編輯專案",visible:t.showDialog,direction:"btt","before-close":t.handleClose,width:"80%"}},[n("el-form",{ref:"myEdit",staticStyle:{width:"70%","margin-left":"10%"},attrs:{model:t.myEdit,"label-position":"left","label-width":"20%"}},[n("el-form-item",{attrs:{label:"活動id"}},[n("el-input",{attrs:{disabled:!0},model:{value:t.myEdit.id,callback:function(e){t.$set(t.myEdit,"id",e)},expression:"myEdit.id"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"campaignID"}},[n("el-input",{attrs:{placeholder:"僅限輸入英文"},model:{value:t.myEdit.campaignID,callback:function(e){t.$set(t.myEdit,"campaignID",e)},expression:"myEdit.campaignID"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"活動名稱"}},[n("el-input",{model:{value:t.myEdit.name,callback:function(e){t.$set(t.myEdit,"name",e)},expression:"myEdit.name"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"活動描述"}},[n("el-input",{attrs:{type:"textarea",rows:5},model:{value:t.myEdit.description,callback:function(e){t.$set(t.myEdit,"description",e)},expression:"myEdit.description"}})],1),t._v(" "),n("el-button",{on:{click:t.save}},[t._v("儲存")])],1)],1)},g=[],v={name:"DialogEditproject",props:{showDialog:{type:Boolean,default:!1},crrentSlect:{type:Object,required:!0}},data:function(){return{myEdit:{}}},watch:{showDialog:function(t){!0===t&&(this.myEdit=Object.assign({},this.crrentSlect))}},methods:{handleClose:function(t){var e=this;this.$confirm("確認關閉？").then((function(n){e.$emit("showEditDialog",!1),t()})).catch((function(t){}))},save:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(JSON.stringify(this.crrentSlect)===JSON.stringify(this.myEdit)){t.next=5;break}return t.next=3,this.$store.dispatch("EDM_project/EDIT_PROJECT_CONTENT",this.myEdit);case 3:return t.next=5,this.$store.dispatch("EDM_project/GET_PROJECT_LIST");case 5:this.$emit("showEditDialog",!1);case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},E=v,b=Object(m["a"])(E,h,g,!1,null,null,null),_=b.exports,D={components:{DialogAddproject:f,DialogEditproject:_},data:function(){return{showAddDialog:!1,showEditDialog:!1,crrentSlect:{},isloading:!1,currentPage:1,pagesize:10}},computed:{tableData:function(){return this.$store.state.EDM_project?this.$store.state.EDM_project.projectList:[]},loadingIcon:{get:function(){return this.isloading?"el-icon-loading":"el-icon-refresh"}}},mounted:function(){void 0===this.$store._modules.root._children.EDM_project&&this.$store.registerModule("EDM_project",c()),this.$store.dispatch("EDM_project/GET_PROJECT_LIST")},beforeDestroy:function(){void 0!==this.$store._modules.root._children.EDM_project&&this.$store.unregisterModule("EDM_project")},methods:{closeDialog:function(){this.showAddDialog=!1,this.showEditDialog=!1},openAddDialog:function(){this.showAddDialog=!0},openEditDialog:function(t){var e=this;this.$store.dispatch("EDM_project/GET_PROJECT_CONTENT",t.id).then((function(n){n.campaignID?(e.crrentSlect.campaignID=n.campaignID,e.crrentSlect.name=n.name,e.crrentSlect.description=n.description,e.crrentSlect.id=t.id,e.showEditDialog=!0):e.$message("查無此專案,請刷新列表")}))},reFreshList:function(){var t=this;this.isloading=!0,this.$store.dispatch("EDM_project/GET_PROJECT_LIST").then((function(e){t.isloading=!1}))},goEDMList:function(t){this.$router.push({name:"EDM列表",query:{id:t}})},handleSizeChange:function(t){this.pagesize=t},handleCurrentChange:function(t){this.currentPage=t}}},y=D,w=Object(m["a"])(y,i,r,!1,null,null,null);e["default"]=w.exports}}]);